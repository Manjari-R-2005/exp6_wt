<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beauty Luxe | User Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background-image: url('https://i.pinimg.com/736x/03/45/17/0345179129fdc6f536f8162cb0a09892.jpg');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      min-height: 100vh;
      padding: 40px;
      color: #333;
    }

    .card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    h2 {
      color: #b30059;
      font-weight: bold;
      text-align: center;
      margin-bottom: 25px;
    }

    .form-control, .form-select {
      border-radius: 12px;
    }

    .btn-custom {
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: bold;
      transition: all 0.3s;
    }

    .btn-custom:hover {
      transform: scale(1.05);
      opacity: 0.9;
    }

    .btn-primary { background-color: #d63384; border: none; }
    .btn-success { background-color: #198754; border: none; }
    .btn-info { background-color: #0dcaf0; border: none; }
    .btn-warning { background-color: #ffc107; border: none; }
    .btn-danger { background-color: #dc3545; border: none; }

    #msg {
      text-align: center;
      font-weight: bold;
      margin-top: 15px;
      color: #dc3545;
    }

    table input, table select {
      font-size: 14px;
      padding: 5px;
      border-radius: 6px;
    }

    table td input {
  border: none;
  background: transparent;
  width: 100%;
  padding: 5px;
  font-size: 14px;
}

.table td {
  vertical-align: middle;
}


.action-buttons {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  flex-wrap: nowrap;
}

.btn-sm {
  border-radius: 12px;
  padding: 4px 10px;
  font-size: 0.85rem;
}

.action-buttons .btn {
  min-width: 35px;
  border-radius: 8px;
  padding: 5px 10px;
  font-size: 13px;
  font-weight: bold;
}

  </style>
</head>
<body>

<div class="container">
  <div class="card">
    <h2>Beauty Luxe - User Profile Management</h2>

    <div class="row mb-3">
      <div class="col-md-6">
        <input type="text" class="form-control" id="name" placeholder="Full Name">
      </div>
      <div class="col-md-6">
        <input type="email" class="form-control" id="email" placeholder="Email Address">
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md-6">
        <input type="password" class="form-control" id="password" placeholder="Password">
      </div>
      <div class="col-md-6">
        <select id="skinType" class="form-select">
          <option value="">Select Skin Type</option>
          <option>Oily</option>
          <option>Dry</option>
          <option>Combination</option>
          <option>Sensitive</option>
          <option>Normal</option>
        </select>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md-6">
        <input type="text" class="form-control" id="favoriteBrand" placeholder="Favorite Makeup Brand">
      </div>
      <div class="col-md-6">
        <input type="text" class="form-control" id="preferredProducts" placeholder="Preferred Products (e.g., Lipstick)">
      </div>
    </div>

    <div class="d-flex justify-content-center gap-3 flex-wrap mb-3">
      <button onclick="register()" class="btn btn-custom btn-primary">Register</button>
      <button onclick="login()" class="btn btn-custom btn-success">Login</button>
      <button onclick="getUsers()" class="btn btn-custom btn-info">Users</button>
    </div>

    <div id="msg"></div>

    <div class="table-responsive mt-4">
      <table class="table table-hover table-bordered align-middle text-center mt-3" id="usersTable" style="display: none;">
        <thead class="table-dark">
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Skin Type</th>
            <th>Brand</th>
            <th>Products</th>
            <th>Password</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="userList"></tbody>
      </table>
      
    </div>
  </div>
</div>

<script>
  async function register() {
    const user = {
      name: document.getElementById("name").value,
      email: document.getElementById("email").value,
      password: document.getElementById("password").value,
      skinType: document.getElementById("skinType").value,
      favoriteBrand: document.getElementById("favoriteBrand").value,
      preferredProducts: document.getElementById("preferredProducts").value,
    };

    const res = await fetch("/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(user)
    });

    const result = await res.json();
    document.getElementById("msg").innerText = result.message || result.error;
  }

  async function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    const res = await fetch("/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });

    const result = await res.json();
    document.getElementById("msg").innerText = result.message || result.error;
  }

  async function getUsers() {
    const res = await fetch("/users");
    const users = await res.json();
    const list = document.getElementById("userList");
    list.innerHTML = "";

    users.forEach(user => {
      list.innerHTML += `
        <tr>
          <td><input value="${user.name}" id="name-${user._id}" class="form-control" /></td>
          <td><input value="${user.email}" id="email-${user._id}" class="form-control" /></td>
          <td><input value="${user.skinType}" id="skinType-${user._id}" class="form-control" /></td>
          <td><input value="${user.favoriteBrand}" id="brand-${user._id}" class="form-control" /></td>
          <td><input value="${user.preferredProducts}" id="products-${user._id}" class="form-control" /></td>
          <td><input value="${user.password}" id="password-${user._id}" class="form-control" /></td>
          <td class="text-center">
            <button onclick="updateUser('${user._id}')" class="btn btn-sm btn-warning me-1"><i class="bi bi-pencil-fill"></i></button>
            <button onclick="deleteUser('${user._id}')" class="btn btn-sm btn-danger"><i class="bi bi-trash-fill"></i></button>
          </td>
        </tr>`;
    });

    document.getElementById("usersTable").style.display = "table";
  }

  async function updateUser(id) {
    const user = {
      name: document.getElementById(`name-${id}`).value,
      email: document.getElementById(`email-${id}`).value,
      password: document.getElementById(`password-${id}`).value,
      skinType: document.getElementById(`skinType-${id}`).value,
      favoriteBrand: document.getElementById(`brand-${id}`).value,
      preferredProducts: document.getElementById(`products-${id}`).value
    };

    const res = await fetch(`/users/${id}`, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(user)
    });

    const result = await res.json();
    document.getElementById("msg").innerText = result.message || result.error;
    getUsers();
  }

  async function deleteUser(id) {
    const res = await fetch(`/users/${id}`, { method: "DELETE" });
    const result = await res.json();
    document.getElementById("msg").innerText = result.message || result.error;
    getUsers();
  }
</script>

</body>
</html>
